{% extends 'base.html' %}
{% load accounts bootstrap i18n ledger %}

{% block breadcrumbs %}
<li><a href="{% url 'dashboard' %}">{% trans 'dashboard' %}</a></li>
<li><a href="{% url 'categories' %}">{% trans 'categories' %}</a></li>
<li><a href="{% url 'category' category.slug %}">{{ category.name|lower }}</a></li>
<li class="active">{% trans 'entries' %}</li>
{% endblock %}

{% block content %}
<script>
    $(function() {
        $('#id_start_date').datepicker({
            dateFormat:'yy-mm-dd',
            firstDay: 1,
            showOtherMonths: true,
            selectOtherMonths: true
        });
        $('#id_end_date').datepicker({
            dateFormat:'yy-mm-dd',
            firstDay: 1,
            showOtherMonths: true,
            selectOtherMonths: true
        });
    });
</script>
{{ form.media }}

<div class="panel panel-default">
    <div class="panel-heading">
        <h1 class="panel-title">
            <a href="{% url 'category' category.slug %}">{{ category|lower }}</a>
            <small>entries</small>
        </h1>
    </div>
    <div class="panel-body">
        <div class="row">
            <div class="col-md-3"><h5><b>total:</b> {% for unit, total in totals.items %}{{ total|colorfy:unit }}{% if not forloop.last %}, {% endif %}{% endfor %}</h5></div>
            <div class="col-md-9">
                <form method="post" class="form-inline">
                    {% csrf_token %}

                    {% for field in form %}
                        {% if field.label != 'Categories' %}
                            <div class="form-group{% if form.errors %} {{ field.errors|yesno:'has-error,has-success' }}{% endif %}">
                                {{ field }}
                            </div>
                        {% endif %}
                    {% endfor %}

                    <button class="btn btn-success" type="submit">filter</button>
                </form>
            </div>
        </div>
    </div>
    {% include 'categories/category/partials/_table.html' with entries=entries options=True %}
    <div class="panel-body">
        {% pagination paginator entries 'entries' %}
    </div>
</div>
{% endblock %}
